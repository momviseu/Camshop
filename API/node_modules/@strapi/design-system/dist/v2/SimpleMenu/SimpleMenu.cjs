"use strict";var Q=Object.defineProperty;var b=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var M=(e,s,t)=>s in e?Q(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,m=(e,s)=>{for(var t in s||(s={}))j.call(s,t)&&M(e,t,s[t]);if(b)for(var t of b(s))_.call(s,t)&&M(e,t,s[t]);return e};var D=(e,s)=>{var t={};for(var a in e)j.call(e,a)&&s.indexOf(a)<0&&(t[a]=e[a]);if(e!=null&&b)for(var a of b(e))s.indexOf(a)<0&&_.call(e,a)&&(t[a]=e[a]);return t};Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const l=require("react"),X=require("prop-types"),Y=require("styled-components"),L=require("@radix-ui/react-use-callback-ref"),Z=require("@strapi/icons/CarretDown"),F=require("../../Typography/Typography.cjs"),I=require("../../Box/Box.cjs"),ee=require("../../Flex/Flex.cjs"),A=require("../../Button/Button.cjs"),te=require("../../BaseLink/BaseLink.cjs"),N=require("../../Popover/Popover.cjs"),$=require("./utils.cjs"),ne=require("../../helpers/useId.cjs"),d=require("../../helpers/keyboardKeys.cjs"),K=e=>e&&typeof e=="object"&&"default"in e?e:{default:e},r=K(l),o=K(X),B=K(Y),oe=K(Z),se=B.default.button`
  border: none;
  padding: 0;
  background: transparent;
  cursor: pointer;
  ${$.getOptionStyle}
`,ae=B.default(te.BaseLink)`
  text-decoration: none;
  ${$.getOptionStyle}
`,re=B.default.span`
  display: flex;
  align-items: center;
  svg {
    height: 4px;
    width: 6px;
  }
`,ue=B.default(A.Button)`
  padding: ${({theme:e})=>`${e.spaces[1]} ${e.spaces[3]}`};
`,S=O=>{var g=O,{as:e,children:s,onClick:t,isFocused:a,isLink:C}=g,P=D(g,["as","children","onClick","isFocused","isLink"]);const i=l.useRef();l.useEffect(()=>{a&&i.current&&i.current.focus()},[a]);const x=m({tabIndex:a?0:-1,ref:i,role:"menuitem"},P),h=c=>{(c.key===d.KeyboardKeys.SPACE||c.key===d.KeyboardKeys.ENTER)&&t()};return C?r.default.createElement(ae,m({as:e},x),r.default.createElement(I.Box,{padding:2},r.default.createElement(F.Typography,null,s))):r.default.createElement(se,m({onKeyDown:h,onMouseDown:t,type:"button"},x),r.default.createElement(I.Box,{padding:2},r.default.createElement(F.Typography,null,s)))};S.defaultProps={as:void 0,onClick(){},isFocused:!1,isLink:!1};S.propTypes={as:o.default.elementType,children:o.default.node.isRequired,isFocused:o.default.bool,isLink:o.default.bool,onClick:o.default.func};const E=x=>{var h=x,{label:e,children:s,id:t,as:a,onOpen:C=()=>{},onClose:P=()=>{},size:O,popoverPlacement:g}=h,i=D(h,["label","children","id","as","onOpen","onClose","size","popoverPlacement"]);const c=l.useRef(),R=ne.useId("simplemenu",t),f=l.useRef(!1),[p,y]=l.useState(!1),[T,q]=l.useState(0),k=l.Children.toArray(s),V=O==="S"?ue:A.Button,W=a||V;l.useEffect(()=>{if(["string","number"].includes(typeof e)){const n=k.findIndex(u=>u.props.children===e);n!==-1&&q(n)}},[e]);const v=L.useCallbackRef(C),w=L.useCallbackRef(P);l.useEffect(()=>{f!=null&&f.current?p?v():w():f.current=!0},[f,p,v,w]),l.useEffect(()=>{r.default.isValidElement(e)&&T===-1&&c.current.focus()},[e,T]);const z=n=>{p&&(n.key===d.KeyboardKeys.ESCAPE&&(n.stopPropagation(),y(!1),c.current.focus()),n.key===d.KeyboardKeys.DOWN&&q(u=>u===k.length-1?0:u+1),n.key===d.KeyboardKeys.UP&&q(u=>u===0?k.length-1:u-1))},U=n=>{(n.key===d.KeyboardKeys.ENTER||n.key===d.KeyboardKeys.SPACE)&&y(u=>!u)},G=n=>{n.preventDefault(),n.currentTarget.contains(n.relatedTarget)||y(!1)},H=n=>{n.preventDefault(),y(u=>!u)},J=k.map((n,u)=>r.default.createElement(ee.Flex,{as:"li",key:u,justifyContent:"center",role:"menuitem"},l.cloneElement(n,{onClick(){n.props.onClick(),y(!1),c.current.focus()},isFocused:T===u})));return r.default.createElement("div",{onKeyDown:z},r.default.createElement(W,m({label:r.default.isValidElement(e)?null:e,"aria-haspopup":!0,"aria-expanded":p,"aria-controls":R,onKeyDown:U,onMouseDown:H,ref:c,type:"button",variant:"ghost",endIcon:r.default.createElement(re,null,r.default.createElement(oe.default,{"aria-hidden":!0}))},i),e),p&&r.default.createElement(N.Popover,{onBlur:G,placement:g,source:c,spacing:4},r.default.createElement(I.Box,{role:"menu",as:"ul",padding:1,id:R},J)))};E.defaultProps={as:void 0};E.displayName="SimpleMenu";E.defaultProps={id:void 0,onClose(){},onOpen(){},popoverPlacement:"bottom-start",size:"M"};E.propTypes={as:o.default.any,children:o.default.oneOfType([o.default.arrayOf(o.default.node),o.default.node]).isRequired,id:o.default.string,label:o.default.oneOfType([o.default.string,o.default.number,o.default.element]).isRequired,onClose:o.default.func,onOpen:o.default.func,popoverPlacement:o.default.oneOf(N.POPOVER_PLACEMENTS),size:o.default.oneOf(["S","M"])};exports.MenuItem=S;exports.SimpleMenu=E;
